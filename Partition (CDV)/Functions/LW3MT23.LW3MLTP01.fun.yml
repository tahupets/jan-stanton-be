Function:
  Enabled For RDMLX:  Yes

  Source: |
    * =======================================================
    * Copyright .....: (C) = LANSA V12 SYSTEM =, 1992
    * Process .......: LW3MLTP01
    * Function ......: LW3MT23
    * Type ..........: LW3WCUST File Level Trigger
    * Created by ....: D08PGMLIB
    * Created on ....: 11/02/06 at 03:07:01
    * Description ...: Trigger for LW3WCUST
    * =======================================================
    Function Options(*DIRECT *LIGHTUSAGE *MLOPTIMISE) Rcv_List(#TRIG_LIST) Trigger(*FILE LW3WCUST)
    * =======================================================
    * Working fields, lists and groups
    * =======================================================
    * At entry #TRIG_LIST will contain 0,1 or 2
    * entries representing current and previous
    * record images of file LW3WCUST. Refer to the
    * Technical Guide for details and examples.
    * Do NOT define any fields in this list. They
    * are automatically included by the compiler.
    Def_List Name(#TRIG_LIST) Type(*WORKING) Entrys(2)
    * =======================================================
    * Function Mainline : LW3MT23
    * =======================================================
    * Assume a "good" return initially
    Change Field(#TRIG_RETC) To('OK')
    *
    * >>> DELETE all "not defined" events from the  <<<
    * >>> the following CASE construct. (ie: Remove <<<
    * >>> WHEN VALUE_IS commands that are not part  <<<
    * >>> of the definition of this trigger BEFORE  <<<
    * >>> specifying details of the events that are <<<
    * >>> part of the definition of this trigger).  <<<
    * >>> This simplifies logic in this function    <<<
    * >>> and ensures an ABORT if someone attempts  <<<
    * >>> to cause it to be invoked during an event <<<
    * >>> that it has not been set up to handle.    <<<
    *
    Case Of_Field(#TRIG_OPER)
    * Handle a before insert event
    When Value_Is('= BEFINS')
    Get_Entry Number(1) From_List(#TRIG_LIST)
    
    * Customer Last Name cannot be blank
    If Cond(#LW3CHLNME *EQ *BLANK)
    Execute Subroutine(message) With_Parms('CE0086')
    #TRIG_RETC := 'VE'
    Endif
    
    * Customer First Name cannot be blank
    If Cond(#LW3CHFNME *EQ *BLANK)
    Execute Subroutine(message) With_Parms('CE0087')
    #TRIG_RETC := 'VE'
    Endif
    
    * Customer Address Line 1 cannot be blank
    If Cond((#LW3CUSIND *NE 'B') *And (#LW3HADDR1 *EQ *BLANK))
    Execute Subroutine(message) With_Parms('CE0088')
    #TRIG_RETC := 'VE'
    Endif
    
    * Customer City cannot be blank
    If Cond((#LW3CUSIND *NE 'B') *And (#LW3CHCITY *EQ *BLANK))
    Execute Subroutine(message) With_Parms('CE0089')
    #TRIG_RETC := 'VE'
    Endif
    
    * Customer State/Province must be selected
    If Cond((#LW3CUSIND *NE 'B') *And (#LW3HSTATE *EQ *BLANK) *And ((#LW3HCNTRY *EQ 'US') *Or (#LW3HCNTRY *EQ 'CA')))
    Execute Subroutine(message) With_Parms('CE0090')
    #TRIG_RETC := 'VE'
    Endif
    
    * Customer Postal Code cannot be blank
    If Cond((#LW3CUSIND *NE 'B') *And (#LW3HPSTAL *EQ *BLANK))
    Execute Subroutine(message) With_Parms('CE0091')
    #TRIG_RETC := 'VE'
    Endif
    
    * Customer Country must be selected
    If Cond((#LW3CUSIND *NE 'B') *And (#LW3HCNTRY *EQ *BLANK))
    Execute Subroutine(message) With_Parms('CE0092')
    #TRIG_RETC := 'VE'
    Endif
    
    * Handle a before update event
    When Value_Is('= BEFUPD')
    Get_Entry Number(1) From_List(#TRIG_LIST)
    
    * Customer Last Name cannot be blank
    If Cond(#LW3CHLNME *EQ *BLANK)
    Execute Subroutine(message) With_Parms('CE0086')
    #TRIG_RETC := 'VE'
    Endif
    
    * Customer First Name cannot be blank
    If Cond(#LW3CHFNME *EQ *BLANK)
    Execute Subroutine(message) With_Parms('CE0087')
    #TRIG_RETC := 'VE'
    Endif
    
    * Customer Address Line 1 cannot be blank
    If Cond((#LW3CUSIND *NE 'B') *And (#LW3HADDR1 *EQ *BLANK))
    Execute Subroutine(message) With_Parms('CE0088')
    #TRIG_RETC := 'VE'
    Endif
    
    * Customer City cannot be blank
    If Cond((#LW3CUSIND *NE 'B') *And (#LW3CHCITY *EQ *BLANK))
    Execute Subroutine(message) With_Parms('CE0089')
    #TRIG_RETC := 'VE'
    Endif
    
    * Customer State/Province must be selected
    If Cond((#LW3CUSIND *NE 'B') *And (#LW3HSTATE *EQ *BLANK) *And ((#LW3HCNTRY *EQ 'US') *Or (#LW3HCNTRY *EQ 'CA')))
    Execute Subroutine(message) With_Parms('CE0090')
    #TRIG_RETC := 'VE'
    Endif
    
    * Customer Postal Code cannot be blank
    If Cond((#LW3CUSIND *NE 'B') *And (#LW3HPSTAL *EQ *BLANK))
    Execute Subroutine(message) With_Parms('CE0091')
    #TRIG_RETC := 'VE'
    Endif
    
    * Customer Country must be selected
    If Cond((#LW3CUSIND *NE 'B') *And (#LW3HCNTRY *EQ *BLANK))
    Execute Subroutine(message) With_Parms('CE0092')
    #TRIG_RETC := 'VE'
    Endif
    
    * Handle an event not catered for
    Otherwise
    Abort Msgtxt('File LW3WCUST trigger function invalidly invoked/ used.')
    Endcase
    * Return control to the invoker
    Return
    
    * Handle retrieval of messages
    Subroutine Name(message) Parms((#LW3VARNAM *RECEIVED))
    Fetch Fields(#LW3VARTXT) From_File(LW3MLNVAR) With_Key(#LW3VARNAM *LANGUAGE)
    If_Status Is(*OKAY)
    Message Msgtxt(#LW3VARTXT)
    Else
    Message Msgtxt('Message not found in multilingual file.')
    Endif
    Endroutine
